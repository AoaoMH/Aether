# 相关概念

## 1. 创建统一模型
1. **左侧模型选择、搜索区域**
   - 模型来源: opencode维护的 [models.dev](https://models.dev)
   - 仅显示几个官方模型提供商, 可以通过搜索获取更多模型
2. **右侧参数配置区域**
   - 手动添加模型 或 选择模型后自动填写
   - 模型偏好: 标定这个模型是否支持这些能力, 一般情况下可不选
   - 价格配置
     - 计费方式: Token价格 + 按次价格 + 视频计费 = 最终计费
     - 价格阶梯: 以总Token数落在哪个区间为准, 并非按阶梯溢出补全式计费

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%209.png)

## 2. 添加提供商
1. **提供商类型**: 自定义或反代; 一般自定义即可, 反代请进入反代章节
2. **计费类型**:
   - 按量付费: 持续使用
   - 月卡额度: 按周期(天)限额
   - 免费套餐: 不计入成本即倍率为0
3. **最大重试次数**
   - 在缓存亲和调度模式下, 首次请求失败后的重试次数。
4. **超时时间**
   - 流式首字超时时间: 流式请求收到首字前的超时时间
   - 非流请求超时时间: 非流请求的总超时时间
5. **保持优先级**
   - 通过格式转换的请求, 是否保持当前优先级。

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2010.png)

## 3. 添加端点

添加端点是添加上游支持的端点, 并非你需要使用的端点. 比如Anyrouter只支持Claude Code接入, 那么就应该仅添加Claude CLI端点。

1. **选择格式**: 选择上游支持的端点
2. **自定义Base URL、Path**: 根据上游提供的信息填写。为空则使用提示的默认值。

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2011.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2012.png)

## 4. 添加密钥
1. **认证类型**
   - API Key: 传统密钥
   - Vertex AI: 用于Google Cloud
2. **支持的API格式**: 勾选Key可以使用的API格式, 同时可以设置key访问该端点时的倍率
3. **优先级**: 在提供商优先的调度模式下, 不同优先级的Key按顺序故障转移, 同优先级的Key进行负载均衡
4. **RPM限制**: 
   Key的使用速率限制, 会预留10%给已有用户进行提高缓存命中率
   - 填写固定数值
   - 不填为空, 采用一定策略自适应学习。
5. **缓存TTL**
   - 0: 不使用缓存优先
   - N: 同一个用户Key在N分钟内, 优先使用之前使用的提供商、Key响应请求。
6. **熔断探测**
   当同一个提供商Key自动连续若干次请求失败后, 会进入熔断状态, 之后每间N分钟进行探测请求, 若请求成功解除熔断后续正常请求, 否则按以指数级增长探测时间以待下次探测, 最大探测间隔不会增长超过32分钟
7. **能力标签**
   定义该Key可以使用的能力
8. **自动获取上游模型**
   在上游获取模型端点支持的情况下, 从接口自动获取可以用模型列表。且按一定时间自动刷新, 不开启则默认任意模型可用, 或在后续模型权限中手动添加。

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2013.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2014.png)

## 5. 模型权限
1. 在编辑密钥中开启自动获取/刷新上游全部模型
2. 手动限制/创建该Key的可用模型
3. 不开启自动获取且勾选任意模型, 即模型权限为空, 则认为可以使用提供商的全部关联模型
4. 只有在模型权限不为空的情况下, 才可以配合正则映射模型

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2015.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2016.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2017.png)

## 6. 关联模型

从全局模型关联提供商模型, 即设置该提供商可以访问的模型, 同时可以在这里设置提供商自己的模型价格。默认继承全局模型的价格

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2018.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2019.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2020.png)

## 7. 模型映射

如果该提供的请求名称并非标准名称, 即可通过映射改变在实际请求提供时的模型id, 比如：
官方标准名称为: `claude-opus-4-6` 实际提供商叫 `claude-opus-4-6-last`

又或者可以降/升级请求模型:
官方标准名称为: `claude-opus-4-6` 实际请求提供商用 `claude-sonnet-4-6`

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2021.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2022.png)

## 8. 反向代理

1. **Codex**
   ![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2023.png)
2. **Krio**
   ![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2024.png)
3. **Antigravity**
   ![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2025.png)

## 9. 优先级管理

允许拖动、或者直接点击数字输入调整优先级

1. **提供商优先**
   按提供商顺序调度, 同优先级负载均衡
2. **Key优先**
   全局Key统一调度, 同优先级负载均衡
3. **缓存亲和模式**
   在KeyTTL时间的约束下, 优先使用上一次请求使用的Key
4. **负载均衡模式**
   - 取消全局提供商优先级,  提供商内部Key依然保持优先级
   - 取消全局Key优先级, 乱序使用
5. **固定顺序模式**
   取消缓存亲和, 始终使用固定顺序Key请求

![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2026.png)
![image.png](/Aether%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image%2027.png)
